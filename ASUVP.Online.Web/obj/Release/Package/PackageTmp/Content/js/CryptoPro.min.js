function getXmlHttp(){var n;try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){n=!1}}return n||typeof XMLHttpRequest=="undefined"||(n=new XMLHttpRequest),n}function include_async_code(){if(async_code_included)return async_Promise;var n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src","Content/js/async_code.js"),document.getElementsByTagName("head")[0].appendChild(n),async_Promise=new Promise(function(n){async_resolve=n}),async_code_included=1,async_Promise}function Common_RetrieveCertificate(){var n=!!cadesplugin.CreateObjectAsync;if(n)include_async_code().then(function(){return RetrieveCertificate_Async()});else return RetrieveCertificate_NPAPI()}function Common_CreateSimpleSign(n){var t=!!cadesplugin.CreateObjectAsync;if(t)include_async_code().then(function(){return CreateSimpleSign_Async(n)});else return CreateSimpleSign_NPAPI(n)}function Common_SignCadesBES(n,t,i){var r=!!cadesplugin.CreateObjectAsync;if(r)include_async_code().then(function(){return SignCadesBES_Async(n,t,i)});else return SignCadesBES_NPAPI(n,t,i)}function Common_SignCadesBES_File(n){var t=!!cadesplugin.CreateObjectAsync;if(t)include_async_code().then(function(){return SignCadesBES_Async_File(n)});else return SignCadesBES_NPAPI_File(n)}function Common_SignCadesXLong(n){var t=!!cadesplugin.CreateObjectAsync;if(t)include_async_code().then(function(){return SignCadesXLong_Async(n)});else return SignCadesXLong_NPAPI(n)}function Common_SignCadesXML(n){var t=!!cadesplugin.CreateObjectAsync;if(t)include_async_code().then(function(){return SignCadesXML_Async(n)});else return SignCadesXML_NPAPI(n)}function Common_CheckForPlugIn(){cadesplugin.set_log_level(cadesplugin.LOG_LEVEL_DEBUG);var n=!!cadesplugin.CreateObjectAsync;if(n)include_async_code().then(function(){return CheckForPlugIn_Async()});else return CheckForPlugIn_NPAPI()}function Common_Encrypt(){var n=!!cadesplugin.CreateObjectAsync;if(n)include_async_code().then(function(){return Encrypt_Async()});else return Encrypt_NPAPI()}function Common_Decrypt(n){var t=!!cadesplugin.CreateObjectAsync;if(t)include_async_code().then(function(){return Decrypt_Async(n)});else return Decrypt_NPAPI(n)}function GetCertificate_NPAPI(n){var r=document.getElementById(n),u=r.selectedIndex,f,t,e,i;if(u==-1){alert("Select certificate");return}f=r.options[u].value.split(" ").reverse().join("").replace(/\s/g,"").toUpperCase();try{t=cadesplugin.CreateObject("CAdESCOM.Store");t.Open()}catch(o){alert("Failed to create CAdESCOM.Store: "+cadesplugin.getLastError(o));return}if(e=0,i=t.Certificates.Find(e,f),i.Count==0){alert("Certificate not found");return}return i.Item(1)}function FillCertInfo_NPAPI(n,t){var u,i,r;typeof t=="undefined"?(u="cert_info",i=""):(u=t,i=t);r=new CertificateObj(n);document.getElementById(u).style.display="";document.getElementById(i+"subject").innerHTML="Владелец: <b>"+r.GetCertName()+"<b>";document.getElementById(i+"issuer").innerHTML="Издатель: <b>"+r.GetIssuer()+"<b>";document.getElementById(i+"from").innerHTML="Выдан: <b>"+r.GetCertFromDate()+"<b>";document.getElementById(i+"till").innerHTML="Действителен до: <b>"+r.GetCertTillDate()+"<b>";document.getElementById(i+"provname").innerHTML="Криптопровайдер: <b>"+r.GetPrivateKeyProviderName()+"<b>";document.getElementById(i+"algorithm").innerHTML="Алгоритм ключа: <b>"+r.GetPubKeyAlgorithm()+"<b>"}function MakeCadesBesSign_NPAPI(n,t,i){var r="",u,f,o,s;try{u=cadesplugin.CreateObject("CAdESCOM.CPSigner")}catch(e){r="Failed to create CAdESCOM.CPSigner: "+e.number;alert(r);throw r;}if(u)u.Certificate=t;else{r="Failed to create CAdESCOM.CPSigner";alert(r);throw r;}try{f=cadesplugin.CreateObject("CAdESCOM.CadesSignedData")}catch(e){alert("Failed to create CAdESCOM.CadesSignedData: "+e.number);return}if(o=1,n){f.ContentEncoding=1;typeof i!="undefined"&&(f.DisplayData=1);f.Content=Base64.encode(n);u.Options=1;try{s=f.SignCades(u,o)}catch(e){r="Не удалось создать подпись из-за ошибки: "+cadesplugin.getLastError(e);alert(cadesplugin.getLastError(e));throw r;}}return s}function MakeCadesXLongSign_NPAPI(n,t,i){var r="",u,e,o,s;try{u=cadesplugin.CreateObject("CAdESCOM.CPSigner")}catch(f){r="Failed to create CAdESCOM.CPSigner: "+f.number;alert(r);throw r;}if(u)u.Certificate=i;else{r="Failed to create CAdESCOM.CPSigner";alert(r);throw r;}try{e=cadesplugin.CreateObject("CAdESCOM.CadesSignedData")}catch(f){alert("Failed to create CAdESCOM.CadesSignedData: "+cadesplugin.getLastError(f));return}if(o=93,n){e.Content=n;u.Options=1;u.TSAAddress=t;try{s=e.SignCades(u,o)}catch(f){r="Не удалось создать подпись из-за ошибки: "+cadesplugin.getLastError(f);alert(r);throw r;}}return s}function MakeXMLSign_NPAPI(n,t){var r,h,i,s;try{r=cadesplugin.CreateObject("CAdESCOM.CPSigner")}catch(e){errormes="Failed to create CAdESCOM.CPSigner: "+e.number;alert(errormes);throw errormes;}if(r)r.Certificate=t;else{errormes="Failed to create CAdESCOM.CPSigner";alert(errormes);throw errormes;}var u="",f="",c=t.PublicKey(),l=c.Algorithm,o=l.Value;if(o=="1.2.643.7.1.1.1.1")u="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102012-gostr34112012-256",f="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34112012-256";else if(o=="1.2.643.7.1.1.1.2")u="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102012-gostr34112012-512",f="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34112012-512";else if(o=="1.2.643.2.2.19")u="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102001-gostr3411",f="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr3411";else{errormes="Данная демо страница поддерживает XML подпись сертификатами с алгоритмом ГОСТ Р 34.10-2012, ГОСТ Р 34.10-2001";throw errormes;}h=0;try{i=cadesplugin.CreateObject("CAdESCOM.SignedXML")}catch(e){alert("Failed to create CAdESCOM.SignedXML: "+cadesplugin.getLastError(e));return}i.Content=n;i.SignatureType=h;i.SignatureMethod=u;i.DigestMethod=f;s="";try{s=i.Sign(r)}catch(e){errormes="Не удалось создать подпись из-за ошибки: "+cadesplugin.getLastError(e);alert(errormes);throw errormes;}return s}function GetSignatureTitleElement(){var n=null,t=document.getElementsByName("SignatureTitle");if(t.length==0){if(n=document.getElementById("SignatureTxtBox").parentNode.previousSibling,n.nodeName=="P")return n}else n=t[0];return n}function SignCadesBES_NPAPI(n,t,i){var u=GetCertificate_NPAPI(n),f=document.getElementById("DataToSignTxtBox").value,r,e;typeof t!="undefined"&&(f=t);r=GetSignatureTitleElement();try{FillCertInfo_NPAPI(u);e=MakeCadesBesSign_NPAPI(f,u,i);document.getElementById("SignatureTxtBox").innerHTML=e;r!=null&&(r.innerHTML="Подпись сформирована успешно:")}catch(o){r!=null&&(r.innerHTML="Возникла ошибка:");document.getElementById("SignatureTxtBox").innerHTML=o}}function SignCadesBES_NPAPI_File(n){var i=GetCertificate_NPAPI(n),r=fileContent,t=GetSignatureTitleElement();try{FillCertInfo_NPAPI(i);var u=Date.now(),f=MakeCadesBesSign_NPAPI(r,i),e=Date.now();document.getElementsByName("TimeTitle")[0].innerHTML="Время выполнения: "+(e-u)+" мс";document.getElementById("SignatureTxtBox").innerHTML=f;t!=null&&(t.innerHTML="Подпись сформирована успешно:")}catch(o){t!=null&&(t.innerHTML="Возникла ошибка:");document.getElementById("SignatureTxtBox").innerHTML=o}}function SignCadesXLong_NPAPI(n){var i=GetCertificate_NPAPI(n),u=document.getElementById("DataToSignTxtBox").value,f=document.getElementById("TSPServiceTxtBox").value,t=GetSignatureTitleElement(),r;try{FillCertInfo_NPAPI(i);r=MakeCadesXLongSign_NPAPI(u,f,i);document.getElementById("SignatureTxtBox").innerHTML=r;t!=null&&(t.innerHTML="Подпись сформирована успешно:")}catch(e){t!=null&&(t.innerHTML="Возникла ошибка:");document.getElementById("SignatureTxtBox").innerHTML=e}}function SignCadesXML_NPAPI(n){var i=GetCertificate_NPAPI(n),u=document.getElementById("DataToSignTxtBox").value,t=GetSignatureTitleElement(),r;try{FillCertInfo_NPAPI(i);r=MakeXMLSign_NPAPI(u,i);document.getElementById("SignatureTxtBox").innerHTML=r;t!=null&&(t.innerHTML="Подпись сформирована успешно:")}catch(f){t!=null&&(t.innerHTML="Возникла ошибка:");document.getElementById("SignatureTxtBox").innerHTML=f}}function MakeVersionString(n){return typeof n=="string"?n:n.MajorVersion+"."+n.MinorVersion+"."+n.BuildVersion}function CheckForPlugIn_NPAPI(){function e(n,t){if(typeof t=="string")return-1;var i=n.split(".");if(t.MajorVersion==parseInt(i[0])){if(t.MinorVersion==parseInt(i[1])){if(t.BuildVersion==parseInt(i[2]))return 0;if(t.BuildVersion<parseInt(i[2]))return-1}else if(t.MinorVersion<parseInt(i[1]))return-1}else if(t.MajorVersion<parseInt(i[0]))return-1;return 1}function o(){var t,n;try{t=cadesplugin.CreateObject("CAdESCOM.About")}catch(i){alert("Failed to create CAdESCOM.About: "+cadesplugin.getLastError(i));return}return n=t.CSPVersion("",75),n.MajorVersion+"."+n.MinorVersion+"."+n.BuildVersion}function s(){var n="",t;try{t=cadesplugin.CreateObject("CAdESCOM.About");n=t.CSPName(75)}catch(i){}return n}function h(n){typeof n!="string"&&(document.getElementById("CSPVersionTxt").innerHTML="Версия криптопровайдера: "+o());var t=s();t!=""&&(document.getElementById("CSPNameTxt").innerHTML="Криптопровайдер: "+t)}function c(n){var i=getXmlHttp();i.open("GET","/sites/default/files/products/cades/latest_2_0.txt",!0);i.onreadystatechange=function(){var r;i.readyState==4&&i.status==200&&(r=i.responseText,u?e(r,n)<0&&(document.getElementById("PluginEnabledImg").setAttribute("src","Img/yellow_dot.png"),document.getElementById("PlugInEnabledTxt").innerHTML="Плагин загружен, но есть более свежая версия."):t?isPluginEnabled?(document.getElementById("PluginEnabledImg").setAttribute("src","Img/red_dot.png"),document.getElementById("PlugInEnabledTxt").innerHTML="Плагин загружен, но не удается создать объекты. Проверьте настройки браузера."):(document.getElementById("PluginEnabledImg").setAttribute("src","Img/red_dot.png"),document.getElementById("PlugInEnabledTxt").innerHTML="Плагин загружен, но отключен в настройках браузера."):(document.getElementById("PluginEnabledImg").setAttribute("src","Img/red_dot.png"),document.getElementById("PlugInEnabledTxt").innerHTML="Плагин не загружен."))};i.send(null)}var t=!1,u=!1,i,n,r,f;try{i=cadesplugin.CreateObject("CAdESCOM.About");t=!0;isPluginEnabled=!0;u=!0;n=i.PluginVersion;typeof n=="undefined"&&(n=i.Version);document.getElementById("PluginEnabledImg").setAttribute("src","Img/green_dot.png");document.getElementById("PlugInEnabledTxt").innerHTML="Плагин загружен.";document.getElementById("PlugInVersionTxt").innerHTML="Версия плагина: "+MakeVersionString(n);h(n)}catch(l){r=navigator.mimeTypes["application/x-cades"];r&&(t=!0,f=r.enabledPlugin,f&&(isPluginEnabled=!0))}c(n);location.pathname.indexOf("symalgo_sample.html")>=0?(FillCertList_NPAPI("CertListBox1"),FillCertList_NPAPI("CertListBox2")):FillCertList_NPAPI("CertListBox")}function CertificateObj(n){this.cert=n;this.certFromDate=new Date(this.cert.ValidFromDate);this.certTillDate=new Date(this.cert.ValidToDate)}function GetFirstCert_NPAPI(){var n,f,i,r,s,u,t;try{n=cadesplugin.CreateObject("CAdESCOM.Store");n.Open()}catch(o){alert("Ошибка при открытии хранилища: "+cadesplugin.getLastError(o));return}f=new Date;try{if(i=n.Certificates.Count,i==0)throw"Cannot find object or property. (0x80092004)";}catch(e){if(r=cadesplugin.getLastError(e),"Cannot find object or property. (0x80092004)"==r||"oStore.Certificates is undefined"==r||"Объект или свойство не найдено. (0x80092004)"==r){n.Close();s=document.getElementById("boxdiv").style.display="";return}}if(i)try{for(u=1;u<=i;u++)if(t=n.Certificates.Item(u),f<t.ValidToDate&&t.HasPrivateKey()&&t.IsValid().Result)return t}catch(e){alert("Ошибка при перечислении сертификатов: "+cadesplugin.getLastError(e));return}}function CreateSimpleSign_NPAPI(){var n,t;oCert=GetFirstCert_NPAPI();n=GetSignatureTitleElement();try{typeof oCert!="undefined"&&(FillCertInfo_NPAPI(oCert),t=MakeCadesBesSign_NPAPI(txtDataToSign,oCert),document.getElementById("SignatureTxtBox").innerHTML=t,n!=null&&(n.innerHTML="Подпись сформирована успешно:"))}catch(i){n!=null&&(n.innerHTML="Возникла ошибка:");document.getElementById("SignatureTxtBox").innerHTML=i}}function FillCertList_NPAPI(n){var t,e,o,c,u,i,f,s,h;try{t=cadesplugin.CreateObject("CAdESCOM.Store");t.Open()}catch(r){alert("Ошибка при открытии хранилища: "+cadesplugin.getLastError(r));return}try{if(e=document.getElementById(n),!e)return}catch(r){return}try{if(o=t.Certificates.Count,o==0)throw"Cannot find object or property. (0x80092004)";}catch(r){t.Close();c=document.getElementById("boxdiv").style.display="";return}for(u=1;u<=o;u++){try{i=t.Certificates.Item(u)}catch(r){alert("Ошибка при перечислении сертификатов: "+cadesplugin.getLastError(r));return}f=document.createElement("OPTION");s=new Date;try{if(s<i.ValidToDate&&i.HasPrivateKey()&&i.IsValid().Result)h=new CertificateObj(i),f.text=h.GetCertString();else continue}catch(r){alert("Ошибка при получении свойства SubjectName: "+cadesplugin.getLastError(r))}try{f.value=i.Thumbprint}catch(r){alert("Ошибка при получении свойства Thumbprint: "+cadesplugin.getLastError(r))}e.options.add(f)}t.Close()}function CreateCertRequest_NPAPI(){var n,t,r,f,u;try{n=cadesplugin.CreateObject("X509Enrollment.CX509PrivateKey")}catch(i){alert("Failed to create X509Enrollment.CX509PrivateKey: "+cadesplugin.getLastError(i));return}n.ProviderName="Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider";n.ProviderType=75;n.KeySpec=1;try{t=cadesplugin.CreateObject("X509Enrollment.CX509CertificateRequestPkcs10")}catch(i){alert("Failed to create X509Enrollment.CX509CertificateRequestPkcs10: "+cadesplugin.getLastError(i));return}t.InitializeFromPrivateKey(1,n,"");try{r=cadesplugin.CreateObject("X509Enrollment.CX500DistinguishedName")}catch(i){alert("Failed to create X509Enrollment.CX500DistinguishedName: "+cadesplugin.getLastError(i));return}f="Test Certificate";r.Encode('CN="'+f.replace(/"/g,'""')+'";');t.Subject=r;var e=cadesplugin.CreateObject("X509Enrollment.CX509ExtensionKeyUsage");e.InitializeEncode(240);t.X509Extensions.Add(e);try{u=cadesplugin.CreateObject("X509Enrollment.CX509Enrollment")}catch(i){alert("Failed to create X509Enrollment.CX509Enrollment: "+cadesplugin.getLastError(i));return}return u.InitializeFromRequest(t),u.CreateRequest(1)}function RetrieveCertificate_NPAPI(){var i=CreateCertRequest_NPAPI(),r="CertRequest="+encodeURIComponent(i)+"&Mode="+encodeURIComponent("newreq")+"&TargetStoreFlags="+encodeURIComponent("0")+"&SaveCert="+encodeURIComponent("no"),n=getXmlHttp(),t;n.open("POST","https://www.cryptopro.ru/certsrv/certfnsh.asp",!0);n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");n.onreadystatechange=function(){var i,r,u,f,o;if(n.readyState==4&&n.status==200){t=n.responseText;i="";isIE()?(r=t.indexOf('sPKCS7 & "')+9,u=t.indexOf("& vbNewLine\r\n\r\n<\/Script>"),i=t.substring(r,u),i=i.replace(new RegExp(" & vbNewLine","g"),";"),i=i.replace(new RegExp("&","g"),"+"),i="var sPKCS7="+i+";"):(r=t.indexOf("var sPKCS7"),u=t.indexOf('sPKCS7 += ""')+13,i=t.substring(r,u));eval(i);try{f=cadesplugin.CreateObject("X509Enrollment.CX509Enrollment")}catch(e){alert("Failed to create X509Enrollment.CX509Enrollment: "+cadesplugin.getLastError(e));return}f.Initialize(1);f.InstallResponse(0,sPKCS7,7,"");o=document.getElementById("boxdiv").style.display="none";location.pathname.indexOf("simple")>=0?location.reload():location.pathname.indexOf("symalgo_sample.html")>=0?(FillCertList_NPAPI("CertListBox1"),FillCertList_NPAPI("CertListBox2")):FillCertList_NPAPI("CertListBox")}};n.send(r)}function Encrypt_NPAPI(){var t,i,e,o,r,n,u,h,c,l,f,a,v,y,p,w;if((document.getElementById("DataEncryptedIV1").innerHTML="",document.getElementById("DataEncryptedIV2").innerHTML="",document.getElementById("DataEncryptedDiversData1").innerHTML="",document.getElementById("DataEncryptedDiversData2").innerHTML="",document.getElementById("DataEncryptedBox1").innerHTML="",document.getElementById("DataEncryptedBox2").innerHTML="",document.getElementById("DataEncryptedKey1").innerHTML="",document.getElementById("DataEncryptedKey2").innerHTML="",document.getElementById("DataDecryptedBox1").innerHTML="",document.getElementById("DataDecryptedBox2").innerHTML="",t=GetCertificate_NPAPI("CertListBox1"),typeof t!="undefined")&&(i=GetCertificate_NPAPI("CertListBox2"),typeof i!="undefined")){e=Base64.encode(document.getElementById("DataToEncrTxtBox1").value);o=Base64.encode(document.getElementById("DataToEncrTxtBox2").value);try{FillCertInfo_NPAPI(t,"cert_info1");FillCertInfo_NPAPI(i,"cert_info2");r="";try{n=cadesplugin.CreateObject("cadescom.symmetricalgorithm")}catch(s){r="Failed to create cadescom.symmetricalgorithm: "+s;alert(r);throw r;}n.GenerateKey();u=n.DiversifyKey();h=u.DiversData;document.getElementById("DataEncryptedDiversData1").value=h;c=u.IV;document.getElementById("DataEncryptedIV1").value=c;l=u.Encrypt(e,1);document.getElementById("DataEncryptedBox1").value=l;f=n.DiversifyKey();a=f.DiversData;document.getElementById("DataEncryptedDiversData2").value=a;v=f.IV;document.getElementById("DataEncryptedIV2").value=v;y=f.Encrypt(o,1);document.getElementById("DataEncryptedBox2").value=y;p=n.ExportKey(t);document.getElementById("DataEncryptedKey1").value=p;w=n.ExportKey(i);document.getElementById("DataEncryptedKey2").value=w;alert("Данные зашифрованы успешно:")}catch(s){alert("Ошибка при шифровании данных:"+s)}}}function Decrypt_NPAPI(n){var i,e,o,s,h,r,t,l,a,u,v,y,p,f,w;if(document.getElementById("DataDecryptedBox1").value="",document.getElementById("DataDecryptedBox2").value="",i=GetCertificate_NPAPI(n),typeof i!="undefined"){e=document.getElementById("DataEncryptedBox1").value;o=document.getElementById("DataEncryptedBox2").value;s=n=="CertListBox1"?"DataEncryptedKey1":"DataEncryptedKey2";h=document.getElementById(s).value;try{FillCertInfo_NPAPI(i,"cert_info_decr");r="";try{t=cadesplugin.CreateObject("cadescom.symmetricalgorithm")}catch(c){r="Failed to create cadescom.symmetricalgorithm: "+c;alert(r);throw r;}t.ImportKey(h,i);l=document.getElementById("DataEncryptedDiversData1").value;a=document.getElementById("DataEncryptedIV1").value;t.DiversData=l;u=t.DiversifyKey();u.IV=a;v=u.Decrypt(e,1);document.getElementById("DataDecryptedBox1").value=Base64.decode(v);y=document.getElementById("DataEncryptedDiversData2").value;p=document.getElementById("DataEncryptedIV2").value;t.DiversData=y;f=t.DiversifyKey();f.IV=p;w=f.Decrypt(o,1);document.getElementById("DataDecryptedBox2").value=Base64.decode(w);alert("Данные расшифрованы успешно:")}catch(c){alert("Ошибка при шифровании данных:"+c)}}}function isIE(){return"Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident\/./i)}function ShowPinPadelogin(){var n=document.getElementById("Login").value,t="<!PINPADFILE UTF8><N>Авторизация<V><N>Подтвердите авторизацию на сайте<V>cryptopro.ru<N>Вход будет произведен с логином<V>"+n;Common_SignCadesBES("CertListBox",t,1)}var isPluginEnabled=!1,fileContent,async_code_included=0,async_Promise,async_resolve,Base64,MakePayment;CertificateObj.prototype.check=function(n){return n<10?"0"+n:n};CertificateObj.prototype.extract=function(n,t){var i,r;return certName="",i=n.indexOf(t),i>=0&&(r=n.indexOf(", ",i),certName=r<0?n.substr(i):n.substr(i,r-i)),certName};CertificateObj.prototype.DateTimePutTogether=function(n){return this.check(n.getUTCDate())+"."+this.check(n.getMonth()+1)+"."+n.getFullYear()+" "+this.check(n.getUTCHours())+":"+this.check(n.getUTCMinutes())+":"+this.check(n.getUTCSeconds())};CertificateObj.prototype.GetCertString=function(){return this.extract(this.cert.SubjectName,"CN=")+"; Выдан: "+this.GetCertFromDate()};CertificateObj.prototype.GetCertFromDate=function(){return this.DateTimePutTogether(this.certFromDate)};CertificateObj.prototype.GetCertTillDate=function(){return this.DateTimePutTogether(this.certTillDate)};CertificateObj.prototype.GetPubKeyAlgorithm=function(){return this.cert.PublicKey().Algorithm.FriendlyName};CertificateObj.prototype.GetCertName=function(){return this.extract(this.cert.SubjectName,"CN=")};CertificateObj.prototype.GetIssuer=function(){return this.extract(this.cert.IssuerName,"CN=")};CertificateObj.prototype.GetPrivateKeyProviderName=function(){return this.cert.PrivateKey.ProviderName};Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(n){var f="",e,t,i,s,h,o,r,u=0;for(n=Base64._utf8_encode(n);u<n.length;)e=n.charCodeAt(u++),t=n.charCodeAt(u++),i=n.charCodeAt(u++),s=e>>2,h=(e&3)<<4|t>>4,o=(t&15)<<2|i>>6,r=i&63,isNaN(t)?o=r=64:isNaN(i)&&(r=64),f=f+this._keyStr.charAt(s)+this._keyStr.charAt(h)+this._keyStr.charAt(o)+this._keyStr.charAt(r);return f},decode:function(n){var t="",e,o,s,h,u,r,f,i=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<n.length;)h=this._keyStr.indexOf(n.charAt(i++)),u=this._keyStr.indexOf(n.charAt(i++)),r=this._keyStr.indexOf(n.charAt(i++)),f=this._keyStr.indexOf(n.charAt(i++)),e=h<<2|u>>4,o=(u&15)<<4|r>>2,s=(r&3)<<6|f,t=t+String.fromCharCode(e),r!=64&&(t=t+String.fromCharCode(o)),f!=64&&(t=t+String.fromCharCode(s));return Base64._utf8_decode(t)},_utf8_encode:function(n){var i,r,t;for(n=n.replace(/\r\n/g,"\n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i},_utf8_decode:function(n){for(var r="",t=0,i=c1=c2=0;t<n.length;)i=n.charCodeAt(t),i<128?(r+=String.fromCharCode(i),t++):i>191&&i<224?(c2=n.charCodeAt(t+1),r+=String.fromCharCode((i&31)<<6|c2&63),t+=2):(c2=n.charCodeAt(t+1),c3=n.charCodeAt(t+2),r+=String.fromCharCode((i&15)<<12|(c2&63)<<6|c3&63),t+=3);return r}};MakePayment=function(n,t,i){return"<!PINPADFILE UTF8><N>Платежное поручение<V>500<N>Сумма<V>"+n+"<N>Дата<V>"+t+"<N>Получатель<V>"+i+'<N>Инн<V>102125125212<N>КПП<V>1254521521<N>Назначение платежа<V>За телематические услуги<N>Банк получателя<V>Сбербанк<N>БИК<V>5005825<N>Номер счета получателя<V>1032221122214422<N>Плательщик<V>ЗАО "Актив-софт"<N>Банк плательщика<V>Банк ВТБ (открытое акционерное общество)<N>БИК<V>044525187<N>Номер счета плательщика<V>30101810700000000187'};